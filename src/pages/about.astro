---
import { contentfulClient } from '../lib/contentful';
import MainLayout from '../layouts/MainLayout.astro';
import ImageHeader from '../components/ImageHeader.astro';
import Subteam from '../components/About/Subteam.astro';
import YearSelector from '../components/About/YearSelector.astro';
import Team from '../components/About/TeamByYear/Team.astro';

interface Subteams {
  fields: {
    subteamTitle: string;
    subteamDescription: string;
    subteamImage: {
      fields: {
        file: {
          url: string;
        };
      };
    };
    // subteamImageAltText: string;
  };
  contentTypeId: string;
}

const response = await contentfulClient.getEntries<Subteams>({
  content_type: 'subteam',
});
console.log(response.items);
---

<MainLayout title="Knight Owls - About Us">
  <ImageHeader title="About Us" background="/images/headers/about.webp" />
  <div class="content">
    <a id="whoarewe"></a>
    <div class="about-us">
      <div data-aos="fade-right">
        <img
          src="/images/aboutus/northern.webp"
          alt="The main entrance of Northern Secondary School"
        />
        <h3>Northern Secondary School</h3>
        <p>
          Northern Secondary School, or as we like to call it, NSS, is located
          near the heart of Toronto, Northern is the third largest secondary
          school in the Toronto District School Board with almost eighteen
          hundred students; it was founded in September 1930. NSS offers many
          programs such as the Specialist High Skills Major Program as well as
          gifted, technology and business streams.
        </p>
      </div>
      <div data-aos="fade-left">
        <img
          src="/images/aboutus/ourTeam.webp"
          alt="Eamonn, Isaac, Jacob and Koby standing around our half finished 2022 robot Sharpie"
        />
        <h3>What We've Been Doing</h3>
        <p class="ourteam">
          Thanks to the generous support of our sponsors, parents, students,
          School Foundation, Parent Council, School Council, our school, and the
          tech department, we have been able to participate in the FIRST
          Robotics Competition (FRC). FRC is an international robotics
          competition where high school teams design, build and program a robot
          to compete in a themed game. Throughout the build-season we have been
          able to develop our skills across various fields including: computer
          aided design (CAD) software, computerized numerical control (CNC)
          machines, 3D printers, programming, electronics control system design,
          business development and problem-solving.
        </p>
      </div>
    </div>
    <a id="teams"></a>
    <div class="subteams" data-aos="zoom-in ">
      <h3>Our Subteams</h3>
      <p>
        Our sub-teams are groups of students that focus on different aspects of
        the robot and team operations. They include our Business, Programming,
        Manufacturing, Design, and the Web Design and Media Teams.
      </p>
    </div>
    <div class="teams">
      {
        response.items.map((item) => {
          return (
            <Subteam
              name={item.fields.subteamTitle}
              image={item.fields.subteamImage.fields.file.url}
              description={item.fields.subteamDescription}
              fadeDirection="left"
            />
          );
        })
      }
    </div>
    <h3 id="people" class="our-team" data-aos="zoom-in" data-aos-once="true">
      Our Members
    </h3>
    <YearSelector />
    <Team classes="showDefault" year="year2" filename="2022-23" />
    <Team year="year1" filename="2021-22" />
  </div>
  <script>
    // Get the element with the id of "yearselector"
    const selector = document.getElementById(
      'yearselector'
    ) as HTMLSelectElement;
    // When the selector changes, change the year to the selected year
    selector.addEventListener('change', function () {
      let newactive = document.querySelector('#' + this.value) as HTMLElement;
      let oldactive = document.querySelector('.people') as HTMLElement;

      removeClass();
      newactive.classList.add('showDefault');

      oldactive.animate([{ opacity: '1' }, { opacity: '.5' }], {
        duration: 1000,
      });
      newactive.animate([{ opacity: '.2' }, { opacity: '1' }], {
        duration: 1000,
      });
    });

    function removeClass() {
      var allElements = document.querySelectorAll('.showDefault');
      for (let i = 0; i < allElements.length; i++) {
        allElements[i].classList.remove('showDefault');
      }
    }
  </script>
  <style>
    .content {
      line-height: 2;
    }
    .about-us {
      display: grid;
      grid-template-columns: 50% 50%;
      align-items: start;
      margin-top: 10%;
      gap: 50px;
      width: fit-content;
      color: black;
      text-align: left;
      width: fit-content;
      margin-right: 50px;
    }
    img {
      height: 100px;
      width: auto;
      border-radius: 10px;
      margin-left: 15px;
    }
    .about-us p {
      padding-right: 15px;
      padding-left: 15px;
      font-size: 20px;
    }
    .about-us h3 {
      padding-right: 15px;
      padding-left: 15px;
      font-size: 32px;
      text-decoration: underline;
      text-decoration-color: var(--blue);
    }
    .subteams {
      text-align: center;
      margin-top: 10%;
    }
    .subteams h3 {
      font-size: 32px;
      text-decoration: underline;
      text-decoration-color: var(--blue);
    }
    .subteams p {
      font-size: 20px;
      padding-left: 50px;
      padding-right: 50px;
    }
    .teams {
      display: grid;
      grid-template-columns: auto;
      row-gap: 30px;
      align-items: center;
      justify-content: center;
      color: black;
      margin-top: 7%;
      width: auto;
    }
    .our-team {
      display: block;
      text-align: center;
      font-size: 50px;
      margin-top: 8%;
      margin-bottom: 0;
      text-decoration: underline;
      text-decoration-color: var(--blue);
    }
  </style>
</MainLayout>
